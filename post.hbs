{{!-- Put this into default.hbs --}}
{{!< default}}

{{#post}}

<header class="i-post-header {{#unless feature_image}}i-no-post-header-image{{/unless}}">

{{#if feature_image}}
    <picture class="i-post-header-img">
        <source 
            srcset="{{img_url feature_image size="m" format="avif"}} 500w,
                    {{img_url feature_image size="l" format="avif"}} 700w,
                    {{img_url feature_image size="xl" format="avif"}} 1000w,
                    {{img_url feature_image size="xxl" format="avif"}} 2000w"
            sizes="100vw" 
            type="image/avif"
        >
        <source 
            srcset="{{img_url feature_image size="m" format="webp"}} 500w,
                    {{img_url feature_image size="l" format="webp"}} 700w,
                    {{img_url feature_image size="xl" format="webp"}} 1000w,
                    {{img_url feature_image size="xxl" format="webp"}} 2000w"
                    sizes="100vw"
            type="image/webp"
        >
        <img class="i-hero-img" src="{{img_url feature_image size="xxl"}}" alt="{{feature_image_alt}}" width="1920" height="1080">
    </picture>
{{/if}}
    
    <div class="i-post-header-grid">
        
            {{> "navbar"}}
            {{> "search"}}
        
        <div class="i-post-header-text">
            <h1>{{title}}</h1>
            <p>{{custom_excerpt}}</p>
        </div>
        {{#is "post"}}
        <div class="i-post-header-meta">
            {{#primary_author}}<p class="i-post-header-meta-author"><a href="{{url}}">By {{name}}</a></p>{{/primary_author}}
            <p class="i-post-header-meta-date">On {{date}}</p>
            <div class="i-post-header-share flex-row">
                <button class="i-icon i-copy-button" aria-label="copy url">
                    <span>
                        <svg viewBox='0 0 24 24' fill='currentColor' aria-hidden='true'><path fill="none" d="M0 0h24v24H0z"/><path d="M6 4v4h12V4h2.007c.548 0 .993.445.993.993v16.014a.994.994 0 0 1-.993.993H3.993A.994.994 0 0 1 3 21.007V4.993C3 4.445 3.445 4 3.993 4H6zm2-2h8v4H8V2z"/></svg>
                    </span>
                    <span class="copied">
                        <svg viewBox='0 0 24 24' fill='currentColor' aria-hidden='true'><path fill="none" d="M0 0h24v24H0z"/><path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.997-6l7.07-7.071-1.414-1.414-5.656 5.657-2.829-2.829-1.414 1.414L11.003 16z"/></svg>
                    </span>
                </button>
                <a class="i-icon" href="https://twitter.com/share?url={{url absolute="true"}}" aria-label="Share on Twitter" target="_blank" rel="noopener noreferrer">
                    <svg viewBox='0 0 24 24' fill='currentColor' aria-hidden='true'><path fill="none" d="M0 0h24v24H0z"/><path d="M22.162 5.656a8.384 8.384 0 0 1-2.402.658A4.196 4.196 0 0 0 21.6 4c-.82.488-1.719.83-2.656 1.015a4.182 4.182 0 0 0-7.126 3.814 11.874 11.874 0 0 1-8.62-4.37 4.168 4.168 0 0 0-.566 2.103c0 1.45.738 2.731 1.86 3.481a4.168 4.168 0 0 1-1.894-.523v.052a4.185 4.185 0 0 0 3.355 4.101 4.21 4.21 0 0 1-1.89.072A4.185 4.185 0 0 0 7.97 16.65a8.394 8.394 0 0 1-6.191 1.732 11.83 11.83 0 0 0 6.41 1.88c7.693 0 11.9-6.373 11.9-11.9 0-.18-.005-.362-.013-.54a8.496 8.496 0 0 0 2.087-2.165z"/></svg>
                </a>
                <a class="i-icon" href="http://www.linkedin.com/shareArticle?mini=true&amp;url={{url absolute='true'}}"
                aria-label="Share on LinkedIn" target="_blank" rel="noopener noreferrer">
                    <svg viewBox='0 0 24 24' fill='currentColor' aria-hidden='true'><path fill="none" d="M0 0h24v24H0z"/><path d="M18.335 18.339H15.67v-4.177c0-.996-.02-2.278-1.39-2.278-1.389 0-1.601 1.084-1.601 2.205v4.25h-2.666V9.75h2.56v1.17h.035c.358-.674 1.228-1.387 2.528-1.387 2.7 0 3.2 1.778 3.2 4.091v4.715zM7.003 8.575a1.546 1.546 0 0 1-1.548-1.549 1.548 1.548 0 1 1 1.547 1.549zm1.336 9.764H5.666V9.75H8.34v8.589zM19.67 3H4.329C3.593 3 3 3.58 3 4.297v15.406C3 20.42 3.594 21 4.328 21h15.338C20.4 21 21 20.42 21 19.703V4.297C21 3.58 20.4 3 19.666 3h.003z"/></svg>
                </a>
                <a class="i-icon" href="http://www.facebook.com/sharer.php?u={{url absolute='true'}}"
                aria-label="Share on Facebook" target="_blank" rel="noopener noreferrer">
                   <svg viewBox='0 0 24 24' fill='currentColor' aria-hidden='true'><path fill="none" d="M0 0h24v24H0z"/><path d="M12 2C6.477 2 2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.879V14.89h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.989C18.343 21.129 22 16.99 22 12c0-5.523-4.477-10-10-10z"/></svg>
                </a>
            </div>
        </div>
        {{/is}}
        {{#if feature_image_caption}}
        <div class="i-post-header-caption flex-row">
            <button class="i-post-header-caption-button">
                <svg viewBox='0 0 24 24' fill='currentColor' aria-hidden='true'><path fill="none" d="M0 0h24v24H0z"/><path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM11 7h2v2h-2V7zm0 4h2v6h-2v-6z"/></svg>
            </button>
                <p class="i-post-header-caption-text">
                    {{feature_image_caption}}
                </p>
        </div>
        {{/if}}
    </div>

</header>

<div class="i-post-container">
    <main class="i-post-container-grid" id="i-main">
        <article class="{{post_class}} i-post-grid">
            {{content}}
        </article>
    </main>

    {{#is "post"}}
    <section class="i-comments">
        {{comments}}
    </section>

    {{#get "posts" limit="3" include="tags" filter="tags:[{{tags.[*].slug}}]+id:-{{id}}" as |related|}}
        {{#if related}}
            <section class="i-related">
                <h2>Read some more</h2>
                <div class="i-card-grid">
                    {{#foreach related}}
                        {{> "line-card"}}
                    {{/foreach}}
                </div>
            </section>
        {{/if}}
    {{/get}}
    {{/is}}
{{/post}}

    {{> "footer"}}
</div>


